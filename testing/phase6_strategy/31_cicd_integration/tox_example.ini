# tox 설정 예시
#
# 예지보전 프로젝트의 다중 환경 테스트 설정입니다.
# 이 파일은 참고용으로, 실제 프로젝트에서는 tox.ini로 저장합니다.
#
# 사용 방법:
#   tox                    # 모든 환경에서 테스트 실행
#   tox -e py311           # Python 3.11에서만 실행
#   tox -e lint            # 린팅만 실행
#   tox -e coverage        # 커버리지만 확인

[tox]
# 실행할 환경 목록
envlist = py39, py310, py311, py312, lint, coverage
# 소스 배포 패키지 빌드 건너뛰기 (빠른 실행)
skipsdist = true

# ============================================================
# 기본 테스트 환경 설정
# ============================================================
[testenv]
# 테스트에 필요한 의존성
deps =
    pytest
    pytest-cov
    pytest-mock
# 테스트 실행 명령
commands =
    pytest tests/ -v --tb=short

# ============================================================
# 린팅 환경 설정
# ============================================================
[testenv:lint]
# 린팅 도구
deps =
    flake8
    mypy
# 린팅 명령
commands =
    flake8 src/ --max-line-length=120 --count --statistics
    mypy src/ --ignore-missing-imports

# ============================================================
# 커버리지 환경 설정
# ============================================================
[testenv:coverage]
deps =
    pytest
    pytest-cov
commands =
    pytest tests/ --cov=src --cov-report=term-missing --cov-fail-under=80

# ============================================================
# flake8 설정 (별도의 .flake8 파일 대신 여기에 포함)
# ============================================================
[flake8]
max-line-length = 120
exclude =
    .git,
    __pycache__,
    .tox,
    venv,
    build,
    dist
# 무시할 규칙
ignore =
    # E501: 라인 길이 (max-line-length로 관리)
    # W503: 연산자 전 줄바꿈 (PEP 8 변경)
    W503

# ============================================================
# pytest 설정 (별도의 pytest.ini 대신 여기에 포함)
# ============================================================
[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
# 기본 옵션
addopts = -v --tb=short
# 마커 등록
markers =
    slow: 느린 테스트 (deselect with '-m "not slow"')
    integration: 통합 테스트
    unit: 단위 테스트
